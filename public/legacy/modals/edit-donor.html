<div id="donor-modal" class="modal">
  <div class="modal-content">
    <div class="modal-header"><h2 id="donor-modal-title">Add Donor</h2><button class="btn btn-icon" onclick="closeModal('donor-modal')"><span style="font-size:1.5rem;">Ã—</span></button></div>
    <div class="modal-body">
      <form id="donor-form">
        <input type="hidden" id="donor-id" />
        <div class="form-group"><label class="form-label">Donor Name*</label><input type="text" id="donor-name" class="form-control" required /></div>
        <div class="form-group"><label class="form-label">Organization</label><input type="text" id="donor-org" class="form-control" /></div>
        <div class="grid grid-2">
          <div class="form-group"><label class="form-label">Email</label><input type="email" id="donor-email" class="form-control" /></div>
          <div class="form-group"><label class="form-label">Phone</label><input type="tel" id="donor-phone" class="form-control" /></div>
        </div>
        <div class="form-group"><label class="form-label">Notes</label><textarea id="donor-notes" class="form-control" rows="2"></textarea></div>
        <div class="form-group"><label class="form-label"><input type="checkbox" id="donor-active" checked /> Active</label></div>
      </form>
    </div>
    <div class="modal-footer"><button class="btn btn-secondary" onclick="closeModal('donor-modal')">Cancel</button><button class="btn btn-primary" onclick="saveDonorModal()">Save Donor</button></div>
  </div>
</div>
<script>
(function(){
  window.openDonorModal = function(d){
    document.getElementById('donor-modal-title').textContent = d && d.id ? 'Edit Donor' : 'Add Donor';
    document.getElementById('donor-id').value = d?.id || '';
    document.getElementById('donor-name').value = d?.name || '';
    document.getElementById('donor-org').value = d?.organization || '';
    document.getElementById('donor-email').value = d?.email || '';
    document.getElementById('donor-phone').value = d?.phone || '';
    document.getElementById('donor-notes').value = d?.notes || '';
    document.getElementById('donor-active').checked = d?.active !== false;
    document.getElementById('donor-modal').style.display='block';
  }
  window.saveDonorModal = async function(){
    const body = {
      id: document.getElementById('donor-id').value || undefined,
      name: document.getElementById('donor-name').value.trim(),
      organization: document.getElementById('donor-org').value.trim(),
      email: document.getElementById('donor-email').value.trim(),
      phone: document.getElementById('donor-phone').value.trim(),
      notes: document.getElementById('donor-notes').value.trim(),
      active: document.getElementById('donor-active').checked
    };
    if (!body.name){ alert('Please enter a name'); return; }
    await window.callApi('/donors',{method:'POST', body: JSON.stringify(body)});
    closeModal('donor-modal');
    if (window.initializeSettingsPage){ window.initializeSettingsPage(); }
  }
})();
</script>

